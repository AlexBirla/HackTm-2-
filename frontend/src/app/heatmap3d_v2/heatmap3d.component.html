<div class="map-container-wrapper">
  <div #mapContainer id="map"></div>

  <!-- Top toolbar: back button + heatmap switch -->
  <div class="toolbar-wrapper">
    <div class="light-switcher-left">
      <button class="go-back-button" routerLink="/home">
        <mat-icon>arrow_left</mat-icon>
        Inapoi
      </button>
    </div>

    <div class="light-switcher">
      <button (click)="switchHeatmap('category')" [class.active]="!policeModeEnabled && currentHeatmap === 'category'">Categorie</button>
      <button (click)="switchHeatmap('security')" [class.active]="!policeModeEnabled && currentHeatmap === 'security'">Securitate</button>
      <button (click)="drawPoliceIsochrone()" [class.active]="policeModeEnabled">Acoperirea Politiei</button>
    </div>
  </div>

  <!-- Light preset switcher -->
  <div class="light-switcher-right">
    <button (click)="onLightPresetClick('day')" [class.active]="currentPreset === 'day'">ðŸŒž</button>
    <button (click)="onLightPresetClick('dawn')" [class.active]="currentPreset === 'dawn'">ðŸŒ…</button>
    <button (click)="onLightPresetClick('dusk')" [class.active]="currentPreset === 'dusk'">ðŸŒ‡</button>
    <button (click)="onLightPresetClick('night')" [class.active]="currentPreset === 'night'">ðŸŒ™</button>
  </div>

  <div class="isochrone-legend">
    <h4>ETA Legend (min)</h4>
    <div><span style="background:#ffffb2"></span> 0â€“5</div>
    <div><span style="background:#fecc5c"></span> 5â€“10</div>
    <div><span style="background:#fd8d3c"></span> 10â€“15</div>
    <div><span style="background:#f03b20"></span> 15+</div>
  </div>

  <!-- Category Legend (Only visible when category heatmap is active) -->
  <div class="legend-container" *ngIf="showCategoryLegend">
    <h4>ðŸ“˜ Categorii</h4>
    <div *ngFor="let entry of categoryColorEntries" class="legend-entry">
      <span class="legend-color" [style.background]="entry[1]"></span>
      <span class="legend-label">{{ entry[0] }}</span>
    </div>
  </div>

  <!-- Security Legend (Only visible when security heatmap is active) -->
  <div class="heatmap-legend" *ngIf="showSecurityLegend">
    <h4>Security Risk</h4>
    <div class="legend-item">
      <span class="legend-swatch" style="background:#ffffff"></span>
      <span class="legend-label">Low</span>
    </div>
    <div class="legend-item">
      <span class="legend-swatch" style="background:#ffd700"></span>
      <span class="legend-label">Moderate</span>
    </div>
    <div class="legend-item">
      <span class="legend-swatch" style="background:#ff8c00"></span>
      <span class="legend-label">High</span>
    </div>
    <div class="legend-item">
      <span class="legend-swatch" style="background:#ff0000"></span>
      <span class="legend-label">Critical</span>
    </div>
  </div>


</div>
